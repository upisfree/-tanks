(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z={}.hasOwnProperty,A=function(a,b){function c(){this.constructor=a}for(var d in b)z.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};for(i=document.getElementsByTagName("canvas")[0],j=i.getContext("2d"),p=640,r=32,q=p/r,h=[],d={CTRL:17,ALT:18,ESC:27,SPACE:32,ENTER:13,ARROW:{UP:38,LEFT:37,DOWN:40,RIGHT:39},W:87,A:65,S:83,D:68},Math.randomInt=function(a,b){return Math.floor(Math.random()*(b-a+1)+a)},g=function(){function a(a,b,c){this.x=a,this.y=b,this.deg=c,0===this.deg&&(this.deg=360)}return a}(),k=function(a,b){var c;return c=new Image,c.src="../textures/"+b+".png",c.onload=function(){var d;return j.save(),"player"===b||"bot"===b?(d=Math.PI/180*a.deg,j.translate(a.x+r/2,a.y+r/2),j.rotate(d),j.drawImage(c,-c.width/2,-c.height/2,c.width,c.height)):j.drawImage(c,a.x,a.y),j.restore()}},o=function(){var a,b,c,d;for(d=[],b=0,c=h.length;c>b;b++)a=h[b],d.push(k(new g(a.v.x*r,a.v.y*r,a.v.deg),a.type));return d},b=function(){function a(a,b){this.v=a,this.type=b,this.i=h.length,("player"!==this.type||"bot"!==this.type)&&h.push(this)}return a}(),f=function(a){function b(a,b,c){this.v=a,this.type=b,this.lives=c}return A(b,a),b.prototype.move=function(a){var b,c,d,e,f,g,i;if(d=a.x,e=a.y,b=a.deg,b&&(this.v.deg=b),this.v.x+d<q&&this.v.x+d>-1&&this.v.y+e<q&&this.v.y+e>-1){for(this.v.x+=d,this.v.y+=e,h[this.i]=this,i=[],f=0,g=h.length;g>f;f++)c=h[f],i.push(this.v.x===c.v.x&&this.v.y===c.v.y&&"hedgehog"===c.type?this.applyDamage(1):void 0);return i}},b.prototype.applyDamage=function(a){return this.lives-=a,this.lives<=0?this.destroy("Tank was destroyed!"):void 0},b.prototype.destroy=function(a){return console.log(a)},b}(b),e=function(a){function b(a){this.v=a,b.__super__.constructor.call(this,this.v,"player",3),this.enableControl(),h.push(this)}return A(b,a),b.prototype.enableControl=function(){return window.onkeydown=function(a){switch(a.keyCode){case d.ARROW.LEFT:case d.A:return m.move(new g(-1,0,270));case d.ARROW.UP:case d.W:return m.move(new g(0,-1,0));case d.ARROW.RIGHT:case d.D:return m.move(new g(1,0,90));case d.ARROW.DOWN:case d.S:return m.move(new g(0,1,180))}}},b.prototype.disableControl=function(){return window.onkeydown=null},b.prototype.destroy=function(){return this.disableControl(),b.__super__.destroy.call(this,"Bye, sir!")},b}(f),c=function(b){function c(b){this.v=b,c.__super__.constructor.call(this,this.v,"bot",2),a.enable(this),h.push(this)}return A(c,b),c.prototype.destroy=function(){return a.disable(this),c.__super__.destroy.call(this,"Bye, bot!")},c.prototype._ai=null,c}(f),x=s=0,v=q-1;v>=0?v>=s:s>=v;x=v>=0?++s:--s)for(y=t=0,w=q-1;w>=0?w>=t:t>=w;y=w>=0?++t:--t)new b(new g(x,y,0),"ground"),n=Math.randomInt(0,100),10>n&&new b(new g(x,y,0),"ground2"),n>10&&20>n&&new b(new g(x,y,0),"ground3"),n>20&&30>n&&new b(new g(x,y,0),"ground4"),90===n&&new b(new g(x,y,0),"puddle"),n>95&&new b(new g(x,y,0),"hedgehog");for(a={enable:function(a){return a._ai=setInterval(function(){var b,c,d,e;switch(b=+(m.v.x-a.v.x),d=+(m.v.y-a.v.y),d>b?(c="x",m.v.x>a.v.x?e="right":m.v.x<a.v.x?e="left":m.v.x===a.v.x&&(m.v.y>a.v.y?a.move(new g(0,0,180)):m.v.y<a.v.y&&a.move(new g(0,0,0)),console.log("Catch you on x axis"))):(c="y",m.v.y>a.v.y?e="down":m.v.y<a.v.y?e="up":m.v.y===a.v.y&&(m.v.x>a.v.x?a.move(new g(0,0,90)):m.v.x<a.v.x&&a.move(new g(0,0,270)),console.log("Catch you on y axis!"))),e){case"up":return a.move(new g(0,-1,0));case"right":return a.move(new g(1,0,90));case"down":return a.move(new g(0,1,180));case"left":return a.move(new g(-1,0,270))}},500)},disable:function(a){return clearInterval(a._ai)}},m=new e(new g(Math.randomInt(0,q-1),Math.randomInt(0,q-1),0)),l=u=0;9>=u;l=++u)new c(new g(Math.randomInt(0,q-1),Math.randomInt(0,q-1),0));setInterval(function(){return o()},16)}).call(this);