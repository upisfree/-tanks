(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y={}.hasOwnProperty,z=function(a,b){function c(){this.constructor=a}for(var d in b)y.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};for(n=640,q=32,o=n/q,p=new PIXI.Stage(4138752),m=new PIXI.autoDetectRenderer(n,n),document.body.appendChild(m.view),i={hedgehogs:[],bots:[]},b={PLAYER:"player",BOT:"bot",HEDGEHOD:"hedgehog",GROUND:"ground",GRAVEL:"gravel",DIRT:"dirt",GRASS:"grass",PUDDLE:"puddle"},e={CTRL:17,ALT:18,ESC:27,SPACE:32,ENTER:13,ARROW:{UP:38,LEFT:37,DOWN:40,RIGHT:39},W:87,A:65,S:83,D:68},Math.randomInt=function(a,b){return Math.floor(Math.random()*(b-a+1)+a)},Math.radiansToDegrees=function(a){return a*(180/Math.PI)},Math.degreesToRadians=function(a){return 0===a&&(a=360),a*(Math.PI/180)},h=function(){return requestAnimFrame(h),m.render(p)},c=function(){function a(a,c,d,e,f){this.x=a,this.y=c,this.rotation=d,this.type=e,this.i=null!=f?f:p.children.length,this.s=new PIXI.Sprite(PIXI.Texture.fromImage("../textures/"+this.type+".png")),this.s.position.x=this.x*q+q/2,this.s.position.y=this.y*q+q/2,this.s.rotation=Math.degreesToRadians(this.rotation),this.s.anchor.x=.5,this.s.anchor.y=.5,p.addChild(this.s),this.type===b.HEDGEHOD&&i.hedgehogs.push(this)}return a}(),g=function(a){function b(a,c,d,e,f){this.x=a,this.y=c,this.rotation=d,this.type=e,this.lives=f,b.__super__.constructor.call(this,this.x,this.y,this.rotation,this.type)}return z(b,a),b.prototype.move=function(a,b,c){var d,e,f,g,h;if(c=Math.degreesToRadians(c),e=p.children[this.i],e.rotation!==c)return e.rotation=c,void(p.children[this.i]=e);if(e.position.x+a*q<n&&e.position.x+a*q>-1&&e.position.y+b*q<n&&e.position.y+b*q>-1){for(this.x+=a,this.y+=b,e.position.x+=a*q,e.position.y+=b*q,h=i.hedgehogs,f=0,g=h.length;g>f;f++)d=h[f],this.x===d.x&&this.y===d.y&&this.applyDamage(1);return p.children[this.i]=e}},b.prototype.applyDamage=function(a){return this.lives-=a,this.lives<=0?this.destroy("Tank was destroyed!"):void 0},b.prototype.destroy=function(a){return this._isAlive=!1,console.log(a)},b.prototype._isAlive=!0,b}(c),f=function(c){function d(a,c,e){this.x=a,this.y=c,this.rotation=e,d.__super__.constructor.call(this,this.x,this.y,this.rotation,b.PLAYER,3),this.enableControl()}return z(d,c),d.prototype.enableControl=function(){var a;return a=this,window.onkeydown=function(b){switch(b.keyCode){case e.ARROW.LEFT:case e.A:return a.move(-1,0,270);case e.ARROW.UP:case e.W:return a.move(0,-1,0);case e.ARROW.RIGHT:case e.D:return a.move(1,0,90);case e.ARROW.DOWN:case e.S:return a.move(0,1,180)}}},d.prototype.disableControl=function(){return window.onkeydown=null},d.prototype.destroy=function(){var b,c,e,f;for(this.disableControl(),f=i.bots,c=0,e=f.length;e>c;c++)b=f[c],b._isAlive===!0&&(a.disable(b),a.random(b));return d.__super__.destroy.call(this,"Bye, sir!")},d}(g),d=function(c){function d(c,e,f){this.x=c,this.y=e,this.rotation=f,d.__super__.constructor.call(this,this.x,this.y,this.rotation,b.BOT,2),a.enable(this),i.bots.push(this)}return z(d,c),d.prototype.destroy=function(){return a.disable(this),d.__super__.destroy.call(this,"Bye, bot!")},d.prototype._ai=null,d}(g),r=t=0,w=o-1;w>=0?w>=t:t>=w;r=w>=0?++t:--t)for(s=u=0,x=o-1;x>=0?x>=u:u>=x;s=x>=0?++u:--u)new c(r,s,0,b.GROUND),l=Math.randomInt(0,100),10>l&&new c(r,s,0,b.GRAVEL),l>10&&20>l&&new c(r,s,0,b.DIRT),l>20&&30>l&&new c(r,s,0,b.GRASS),90===l&&new c(r,s,0,b.PUDDLE),l>95&&new c(r,s,0,b.HEDGEHOD);for(a={enable:function(a){return a._ai=setInterval(function(){var b,c,d,e;switch(b=+(k.x-a.x),d=+(k.y-a.y),d>b?(c="x",k.x>a.x?e="right":k.x<a.x?e="left":k.x===a.x&&(k.y>a.y?a.move(0,0,180):k.y<a.y&&a.move(0,0,0),console.log("Catch you on x axis"))):(c="y",k.y>a.y?e="down":k.y<a.y?e="up":k.y===a.y&&(k.x>a.x?a.move(0,0,90):k.x<a.x&&a.move(0,0,270),console.log("Catch you on y axis!"))),e){case"up":return a.move(0,-1,0);case"right":return a.move(1,0,90);case"down":return a.move(0,1,180);case"left":return a.move(-1,0,270)}},500)},disable:function(a){return clearInterval(a._ai)},random:function(a){return a._ai=setInterval(function(){var b;switch(b=Math.randomInt(0,3)){case 0:return a.move(0,-1,0);case 1:return a.move(1,0,90);case 2:return a.move(0,1,180);case 3:return a.move(-1,0,270)}},1e3)}},k=new f(Math.randomInt(0,o-1),Math.randomInt(0,o-1),0),j=v=0;9>=v;j=++v)new d(Math.randomInt(0,o-1),Math.randomInt(0,o-1),0);requestAnimFrame(h)}).call(this);